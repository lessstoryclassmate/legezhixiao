# ç”¨æˆ·ç³»ç»Ÿå®Œå–„æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è§ˆ

ä¹é˜ä¹‹æ™“ç”¨æˆ·ç³»ç»Ÿç°å·²å®Œå–„ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

### âœ… å·²å®ç°åŠŸèƒ½

1. **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ**
   - ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç™»å‡º
   - å¯†ç é‡ç½®åŠŸèƒ½
   - è®°ä½ç™»å½•çŠ¶æ€
   - è‡ªåŠ¨ç™»å½•éªŒè¯

2. **ç”¨æˆ·è§’è‰²ç®¡ç†**
   - **æ™®é€šç”¨æˆ·** (USER): åŸºç¡€åˆ›ä½œåŠŸèƒ½
   - **é«˜çº§ç”¨æˆ·** (PREMIUM): å¢å¼ºåŠŸèƒ½å’ŒAIè¾…åŠ©
   - **ç®¡ç†å‘˜** (ADMIN): ç³»ç»Ÿç®¡ç†æƒé™

3. **è®¢é˜…ç³»ç»Ÿ**
   - **å…è´¹ç‰ˆ** (FREE): åŸºç¡€åŠŸèƒ½ï¼Œé™åˆ¶é¡¹ç›®æ•°é‡
   - **åŸºç¡€ç‰ˆ** (BASIC): å¢åŠ AIå»ºè®®å’Œäº‘åŒæ­¥
   - **é«˜çº§ç‰ˆ** (PREMIUM): æ— é™é¡¹ç›®ã€åä½œã€é«˜çº§å¯¼å‡º
   - **ä¼ä¸šç‰ˆ** (ENTERPRISE): æ‰€æœ‰åŠŸèƒ½æ— é™åˆ¶

4. **æƒé™ç®¡ç†**
   - åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ (RBAC)
   - åŠŸèƒ½çº§åˆ«çš„è®¿é—®æ§åˆ¶
   - æƒé™ä¿æŠ¤ç»„ä»¶

5. **ç”¨æˆ·ç•Œé¢**
   - ç™»å½•/æ³¨å†Œæ¨¡æ€æ¡†
   - ç”¨æˆ·å¤´åƒå’Œèœå•
   - ä¸ªäººèµ„æ–™ç®¡ç†
   - åˆ›ä½œç»Ÿè®¡å±•ç¤º

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒæ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ types/index.ts              # ç”¨æˆ·ç›¸å…³ç±»å‹å®šä¹‰
â”œâ”€â”€ services/authService.ts     # è®¤è¯æœåŠ¡
â”œâ”€â”€ contexts/AuthContext.tsx    # è®¤è¯ä¸Šä¸‹æ–‡
â”œâ”€â”€ hooks/usePermissions.ts     # æƒé™ç®¡ç†Hook
â””â”€â”€ components/Auth/
    â”œâ”€â”€ AuthModal.tsx           # è®¤è¯æ¨¡æ€æ¡†
    â”œâ”€â”€ LoginForm.tsx           # ç™»å½•è¡¨å•
    â”œâ”€â”€ RegisterForm.tsx        # æ³¨å†Œè¡¨å•
    â”œâ”€â”€ ResetPasswordForm.tsx   # é‡ç½®å¯†ç è¡¨å•
    â”œâ”€â”€ UserMenu.tsx            # ç”¨æˆ·èœå•
    â”œâ”€â”€ UserProfileModal.tsx    # ç”¨æˆ·èµ„æ–™æ¨¡æ€æ¡†
    â”œâ”€â”€ PermissionGuard.tsx     # æƒé™ä¿æŠ¤ç»„ä»¶
    â””â”€â”€ AuthModal.css           # æ ·å¼æ–‡ä»¶
```

### ä¸»è¦ç±»å‹å®šä¹‰

```typescript
// ç”¨æˆ·è§’è‰²
enum UserRole {
    USER = 'user',
    PREMIUM = 'premium',
    ADMIN = 'admin'
}

// è®¢é˜…ç­‰çº§
enum SubscriptionTier {
    FREE = 'free',
    BASIC = 'basic',
    PREMIUM = 'premium',
    ENTERPRISE = 'enterprise'
}

// ç”¨æˆ·æ¥å£
interface User {
    id: string
    username: string
    email: string
    displayName: string
    avatar?: string
    role: UserRole
    subscription: SubscriptionTier
    // ... å…¶ä»–å­—æ®µ
}
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. åŸºç¡€è®¤è¯

```tsx
import { useAuth } from '../contexts/AuthContext'

function MyComponent() {
    const { user, isAuthenticated, login, logout } = useAuth()
    
    if (!isAuthenticated) {
        return <div>è¯·å…ˆç™»å½•</div>
    }
    
    return <div>æ¬¢è¿ï¼Œ{user?.displayName}</div>
}
```

### 2. æƒé™æ£€æŸ¥

```tsx
import { usePermissions, PERMISSIONS } from '../hooks/usePermissions'

function CreateProjectButton() {
    const { hasPermission, canCreateProject } = usePermissions()
    
    if (!canCreateProject()) {
        return <div>å·²è¾¾åˆ°é¡¹ç›®åˆ›å»ºä¸Šé™</div>
    }
    
    return <button>åˆ›å»ºæ–°é¡¹ç›®</button>
}
```

### 3. æƒé™ä¿æŠ¤ç»„ä»¶

```tsx
import { PermissionGuard, RequirePremium } from '../components/Auth/PermissionGuard'

function AdminPanel() {
    return (
        <PermissionGuard permissions={['admin_panel']}>
            <div>ç®¡ç†å‘˜é¢æ¿å†…å®¹</div>
        </PermissionGuard>
    )
}

function PremiumFeature() {
    return (
        <RequirePremium feature="advanced_analytics">
            <div>é«˜çº§åˆ†æåŠŸèƒ½</div>
        </RequirePremium>
    )
}
```

### 4. ç”¨æˆ·èœå•é›†æˆ

```tsx
import UserMenu from '../components/Auth/UserMenu'

function Header() {
    return (
        <header>
            <div>Logo</div>
            <UserMenu placement="bottomRight" />
        </header>
    )
}
```

## ğŸ¨ UI ç»„ä»¶ç‰¹æ€§

### è®¤è¯æ¨¡æ€æ¡†
- æ”¯æŒç™»å½•ã€æ³¨å†Œã€é‡ç½®å¯†ç ä¸‰ç§æ¨¡å¼
- è‡ªåŠ¨åˆ‡æ¢å’ŒçŠ¶æ€ç®¡ç†
- è¡¨å•éªŒè¯å’Œé”™è¯¯æç¤º
- å“åº”å¼è®¾è®¡

### ç”¨æˆ·èœå•
- ç”¨æˆ·å¤´åƒå’Œä¿¡æ¯å±•ç¤º
- è®¢é˜…çŠ¶æ€æ ‡è¯†
- åˆ›ä½œç»Ÿè®¡é¢„è§ˆ
- å¿«é€Ÿæ“ä½œèœå•

### ä¸ªäººèµ„æ–™ç®¡ç†
- åŸºæœ¬ä¿¡æ¯ç¼–è¾‘
- å¤´åƒä¸Šä¼ åŠŸèƒ½
- åˆ›ä½œç»Ÿè®¡å±•ç¤º
- è´¦æˆ·ä¿¡æ¯æŸ¥çœ‹

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **å®¢æˆ·ç«¯å®‰å…¨**
   - JWT Token ç®¡ç†
   - è‡ªåŠ¨è¿‡æœŸæ£€æŸ¥
   - å®‰å…¨çš„æœ¬åœ°å­˜å‚¨

2. **æƒé™éªŒè¯**
   - é¡µé¢çº§æƒé™æ£€æŸ¥
   - ç»„ä»¶çº§è®¿é—®æ§åˆ¶
   - API è°ƒç”¨æƒé™éªŒè¯

3. **æ•°æ®ä¿æŠ¤**
   - æ•æ„Ÿä¿¡æ¯åŠ å¯†
   - å®‰å…¨çš„å¯†ç å¤„ç†
   - ç”¨æˆ·éšç§ä¿æŠ¤

## ğŸ“Š ç”¨æˆ·ä½“éªŒ

### ç™»å½•æµç¨‹
1. ç‚¹å‡»"ç™»å½•/æ³¨å†Œ"æŒ‰é’®
2. é€‰æ‹©ç™»å½•æ–¹å¼
3. è¾“å…¥é‚®ç®±å’Œå¯†ç 
4. å¯é€‰æ‹©"è®°ä½æˆ‘"
5. ç™»å½•æˆåŠŸåè‡ªåŠ¨å…³é—­æ¨¡æ€æ¡†

### æ³¨å†Œæµç¨‹
1. ç‚¹å‡»"ç«‹å³æ³¨å†Œ"
2. å¡«å†™ç”¨æˆ·ä¿¡æ¯
3. åŒæ„ç”¨æˆ·åè®®
4. æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨ç™»å½•

### æƒé™æç¤º
- è®¿é—®å—é™åŠŸèƒ½æ—¶æ˜¾ç¤ºå‹å¥½æç¤º
- æä¾›å‡çº§å¼•å¯¼
- æ¸…æ™°çš„æƒé™è¯´æ˜

## ğŸ”„ çŠ¶æ€ç®¡ç†

### AuthContext æä¾›çš„çŠ¶æ€å’Œæ–¹æ³•

```typescript
interface AuthContextType {
    // çŠ¶æ€
    user: User | null
    isAuthenticated: boolean
    isLoading: boolean
    error: string | null
    
    // æ–¹æ³•
    login: (credentials: LoginCredentials) => Promise<void>
    register: (data: RegisterData) => Promise<void>
    logout: () => Promise<void>
    updateProfile: (updates: Partial<User>) => Promise<void>
    // ... å…¶ä»–æ–¹æ³•
}
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æƒé™æ£€æŸ¥
- åœ¨ç»„ä»¶çº§åˆ«è¿›è¡Œæƒé™æ£€æŸ¥
- ä½¿ç”¨æƒé™ä¿æŠ¤ç»„ä»¶åŒ…è£…æ•æ„Ÿå†…å®¹
- æä¾›é™çº§ä½“éªŒå’Œå‡çº§å¼•å¯¼

### 2. ç”¨æˆ·ä½“éªŒ
- ä¿æŒç™»å½•çŠ¶æ€çš„æŒä¹…åŒ–
- æä¾›æ¸…æ™°çš„é”™è¯¯æ¶ˆæ¯
- ä¼˜é›…çš„åŠ è½½çŠ¶æ€å¤„ç†

### 3. æ€§èƒ½ä¼˜åŒ–
- æ‡’åŠ è½½æƒé™ç›¸å…³ç»„ä»¶
- ç¼“å­˜ç”¨æˆ·æƒé™ä¿¡æ¯
- æœ€å°åŒ–é‡å¤çš„æƒé™æ£€æŸ¥

## ğŸš§ åç»­æ‰©å±•

### è®¡åˆ’åŠŸèƒ½
1. **ç¤¾äº¤ç™»å½•**: å¾®ä¿¡ã€QQã€å¾®åšç™»å½•
2. **äºŒæ­¥éªŒè¯**: çŸ­ä¿¡/é‚®ç®±éªŒè¯ç 
3. **å›¢é˜Ÿåä½œ**: å¤šç”¨æˆ·åä½œç¼–è¾‘
4. **æ•°æ®å¤‡ä»½**: è‡ªåŠ¨äº‘ç«¯å¤‡ä»½
5. **å®¡è®¡æ—¥å¿—**: ç”¨æˆ·æ“ä½œè®°å½•

### æŠ€æœ¯ä¼˜åŒ–
1. **æœåŠ¡ç«¯é›†æˆ**: çœŸå®çš„APIæ¥å£
2. **ç¼“å­˜ç­–ç•¥**: Redisç¼“å­˜ç”¨æˆ·çŠ¶æ€
3. **ç›‘æ§å‘Šè­¦**: ç”¨æˆ·è¡Œä¸ºåˆ†æ
4. **æ€§èƒ½ä¼˜åŒ–**: å»¶è¿ŸåŠ è½½å’Œé¢„åŠ è½½

## ğŸ’¡ å¼€å‘æç¤º

### æ¼”ç¤ºè´¦æˆ·
å½“å‰ç³»ç»ŸåŒ…å«ä¸€ä¸ªæ¼”ç¤ºç®¡ç†å‘˜è´¦æˆ·ï¼š
- é‚®ç®±: admin@legezhixiao.com
- å¯†ç : ä»»æ„å¯†ç ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰

### æœ¬åœ°å¼€å‘
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check
```

## ğŸ“ æ€»ç»“

ç”¨æˆ·ç³»ç»Ÿç°å·²å®Œå…¨é›†æˆåˆ°ä¹é˜ä¹‹æ™“é¡¹ç›®ä¸­ï¼Œæä¾›äº†å®Œæ•´çš„è®¤è¯ã€æˆæƒã€ç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚ç³»ç»Ÿè®¾è®¡è€ƒè™‘äº†å¯æ‰©å±•æ€§ã€å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œä¸ºåç»­çš„åŠŸèƒ½å¼€å‘å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

æ‰€æœ‰ç»„ä»¶éƒ½ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œéµå¾ª React æœ€ä½³å®è·µï¼Œå¹¶æä¾›äº†å®Œæ•´çš„ TypeScript ç±»å‹æ”¯æŒã€‚
