# 项目会话管理功能使用指南

## 功能概述

AI助手现在支持项目级别的会话管理，让您可以在不同项目之间切换，每个项目都有独立的对话历史记录。这对于同时进行多个写作项目的作者非常有用。

## 新增功能

### 🎯 增强的历史会话按钮
- **醒目显示**: 历史会话按钮现在有边框和背景，更容易识别
- **会话数量徽章**: 显示当前有多少个项目会话，带有动态徽章动画
- **悬停效果**: 鼠标悬停时有光泽扫过效果

### 📏 窗口大小调整功能
- **可调整大小**: 现在可以通过拖拽窗口边缘调整AI助手窗口的大小
- **多方向调整**: 支持8个方向的大小调整（四边 + 四个角）
- **视觉反馈**: 调整大小时窗口边框变蓝，有缩放动画效果
- **智能限制**: 设有最小和最大尺寸限制，防止窗口过小或超出屏幕

## 主要功能

### 1. 自动项目检测
- 当您在不同的项目页面（如 `/project/123/write`）使用AI助手时，系统会自动检测当前项目ID
- 每个项目的对话会自动保存到对应的会话中

### 2. 项目会话隔离
- 每个项目都有独立的对话历史
- 切换项目时，AI助手会自动加载对应项目的历史对话
- 不同项目的对话不会相互干扰

### 3. 会话历史管理
- 点击AI助手标题栏的"📋 历史"按钮可以查看所有项目的会话
- 按钮显示当前项目数量的徽章，让您一目了然
- 支持搜索功能，可以在所有项目中搜索特定内容
- 可以快速切换到任意项目的会话

### 4. 窗口自定义
- **自由拖拽**: 点击标题栏可以拖拽窗口到任意位置，包括屏幕外
- **智能限制**: 只限制窗口顶部不能完全隐藏，保证用户始终能访问标题栏
- **快速回位**: 双击标题栏可以将超出屏幕的窗口快速拖回屏幕内
- **大小调整**: 拖拽窗口边缘或角落可以调整窗口大小，支持超大尺寸
- **最小化/最大化**: 使用标题栏按钮快速调整窗口状态
- **记忆设置**: 窗口位置和大小会在会话中保持
- **边界提示**: 当窗口大部分超出屏幕时，会有红色边框提示

### 5. 项目统计信息
- 查看每个项目的消息数量
- 显示最后活动时间
- 统计用户消息和AI回复的数量

## 使用方法

### 基本使用
1. 在任意项目页面打开AI助手
2. 开始对话，消息会自动保存到当前项目
3. 切换到其他项目时，对话历史会自动切换

### 调整窗口大小和位置
1. **自由拖拽**: 拖拽标题栏可以将窗口移动到任意位置，包括屏幕外
2. **边缘调整**: 将鼠标移到窗口边缘，光标变为调整图标时拖拽
3. **角落调整**: 拖拽窗口四个角落可以同时调整宽度和高度
4. **右下角指示器**: 右下角有特殊的调整大小指示器，更容易操作
5. **快速回位**: 双击标题栏可以将超出屏幕的窗口拖回屏幕内

### 查看会话历史
1. 点击AI助手标题栏的"📋 历史 (数字)"按钮
2. 在弹出的窗口中可以看到所有项目的会话摘要
3. 徽章数字显示当前有多少个项目会话
4. 点击任意项目可以快速切换到该项目的会话

### 搜索功能
1. 在会话历史窗口中使用搜索框
2. 输入关键词可以在所有项目中搜索相关对话
3. 搜索结果会显示匹配的消息和所属项目

### 管理会话
- **清空当前项目对话**: 点击AI助手的"清空"按钮只会清空当前项目的对话
- **删除项目会话**: 在会话历史窗口中点击删除按钮可以删除整个项目的会话记录

## 技术特性

### 数据持久化
- 所有会话数据保存在浏览器的 localStorage 中
- 即使关闭浏览器，会话历史也会保留
- 支持跨页面的会话同步

### 智能项目识别
- 自动从URL路由中提取项目ID
- 支持通用会话（当没有项目ID时）
- 项目标题可以自定义

### 高性能设计
- 使用单例模式的会话管理器，确保数据一致性
- 优化的数据结构，支持快速搜索和切换
- 消息按时间倒序排列，最新消息在前

### 拖拽和定位增强
- **无边界拖拽**: 窗口可以拖拽到屏幕外，不受传统边界限制
- **顶部保护**: 只限制窗口顶部，确保标题栏始终可访问
- **边界警告**: 当窗口大部分超出屏幕时显示红色边框提示
- **智能回位**: 双击标题栏自动将窗口拖回合适位置
- **悬停提示**: 标题栏悬停时显示"双击可将窗口拖回屏幕内"提示

## 界面指示

### 标题栏显示
- AI助手标题栏会显示当前项目名称
- 项目模式下会显示项目图标
- 显示当前模式：写作模式/创作模式

### 历史按钮增强
- 带有边框和半透明背景的醒目按钮
- 显示项目数量的动态徽章
- 悬停时有光泽扫过动画效果

### 调整大小指示
- 鼠标悬停在窗口边缘时显示半透明的调整区域
- 右下角有特殊的条纹指示器
- 调整大小时窗口边框变为蓝色

### 会话状态
- 当前项目会在会话历史中高亮显示
- 显示每个项目的消息数量和最后活动时间
- 支持响应式设计，在移动设备上也能正常使用

## 最佳实践

1. **项目命名**: 给项目起一个有意义的名称，便于在会话历史中识别
2. **窗口布局**: 根据您的工作习惯调整窗口大小和位置
3. **定期清理**: 对于完成的项目，可以删除不需要的会话记录
4. **充分利用搜索**: 使用搜索功能快速找到之前讨论过的内容
5. **分类对话**: 不同类型的创作任务使用不同的项目，保持会话的针对性

## 注意事项

- 会话数据存储在本地浏览器中，清空浏览器数据会丢失会话记录
- 建议定期备份重要的对话内容
- 当项目数量较多时，使用搜索功能更高效
- 窗口大小调整在触摸屏设备上可能不如鼠标操作精确

这些增强功能让AI助手真正成为您多项目创作的智能伙伴，提供更灵活、更直观的用户体验！
