<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RxDB导入测试</title>
</head>
<body>
    <h1>RxDB导入测试</h1>
    <div id="output"></div>

    <script type="module">
        const output = document.getElementById('output');
        
        function log(message) {
            const div = document.createElement('div');
            div.textContent = message;
            output.appendChild(div);
            console.log(message);
        }

        try {
            log('开始测试RxDB导入...');
            
            // 测试基本导入
            import('rxdb').then(rxdb => {
                log('✅ RxDB基本模块导入成功');
                log(`RxDB版本信息: ${Object.keys(rxdb).length} 个导出`);
                
                // 测试存储引擎导入
                import('rxdb/plugins/storage-dexie').then(storageModule => {
                    log('✅ Dexie存储模块导入成功');
                    
                    // 尝试创建数据库
                    const { createRxDatabase } = rxdb;
                    const { getRxStorageDexie } = storageModule;
                    
                    createRxDatabase({
                        name: 'test_import_db',
                        storage: getRxStorageDexie(),
                        ignoreDuplicate: true
                    }).then(db => {
                        log('✅ 测试数据库创建成功！');
                        return db.destroy();
                    }).then(() => {
                        log('✅ 所有测试通过！');
                    }).catch(err => {
                        log(`❌ 数据库创建失败: ${err.message}`);
                    });
                    
                }).catch(err => {
                    log(`❌ 存储模块导入失败: ${err.message}`);
                });
                
            }).catch(err => {
                log(`❌ RxDB导入失败: ${err.message}`);
            });
            
        } catch (err) {
            log(`❌ 脚本执行错误: ${err.message}`);
        }
    </script>
</body>
</html>
